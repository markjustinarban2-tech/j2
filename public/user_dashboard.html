<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>J2 Nexus — User Dashboard</title>
<style>
  * { box-sizing:border-box; margin:0; padding:0; font-family: 'Segoe UI', Arial, sans-serif; }
  body { background:#f5f6f8; min-height:100vh; }
  header { background:#2563eb; color:white; padding:15px 30px; display:flex; justify-content:space-between; align-items:center; }
  header h1 { font-size:24px; }
  header button { background:#ff4d4f; color:white; border:none; padding:8px 16px; border-radius:6px; cursor:pointer; }
  header button:hover { background:#d9363e; }

  main { padding:20px; }
  .products { display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:20px; }
  .product-card { background:#fff; padding:14px; border-radius:10px; box-shadow:0 4px 12px rgba(0,0,0,0.1); transition:0.2s; }
  .product-card:hover { transform:translateY(-4px); }
  .product-card img { width:100%; height:200px; object-fit:cover; border-radius:10px; margin-bottom:10px; }
  .product-card h3 { margin-bottom:6px; font-size:18px; }
  .product-card p { color:#555; font-size:14px; margin-bottom:6px; }
  .product-card .price { font-weight:700; color:#2563eb; margin-bottom:6px; }

  @media(max-width:768px){ .products { grid-template-columns:1fr; } }
</style>
</head>
<body>

<header>
  <h1>J2 Nexus</h1>
  <button id="logoutBtn">Logout</button>
</header>

<main>
  <h2>Available Products</h2>
  <div class="products" id="productsContainer">
    <!-- Products will be dynamically loaded here -->
  </div>
</main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
import { getFirestore, collection, getDocs, orderBy, query } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAKYSKoY23MbBX9g2PrXoxSuKtTEpaNxcw",
  authDomain: "j2nexuss-a7b99.firebaseapp.com",
  projectId: "j2nexuss-a7b99",
  storageBucket: "j2nexuss-a7b99.appspot.com",
  messagingSenderId: "456617087462",
  appId: "1:456617087462:web:be5dba59b5a117cab38627"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Check login
onAuthStateChanged(auth, (user) => {
  if (!user) window.location.href = "login.html";
});

// Logout
document.getElementById("logoutBtn").addEventListener("click", async () => {
  await signOut(auth);
  window.location.href = "login.html";
});

// Load products
async function loadProducts() {
  const container = document.getElementById("productsContainer");
  container.innerHTML = "";

  const q = query(collection(db, "products"), orderBy("createdAt", "desc"));
  const snapshot = await getDocs(q);

  snapshot.forEach(docSnap => {
    const product = docSnap.data();
    const card = document.createElement("div");
    card.className = "product-card";
    card.innerHTML = `
      <img src="${product.image}" alt="${product.name}" />
      <h3>${product.name}</h3>
      <p>${product.description}</p>
      <div class="price">₱${product.price}</div>
    `;
    container.appendChild(card);
  });
}

// Load products on page load
loadProducts();
</script>

</body>
</html>
